<mxfile host="app.diagrams.net" modified="2023-08-10T06:10:46.008Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36 Edg/115.0.1901.188" etag="Wy6H5VUq051lbyw9WDs2" version="21.6.7" type="github">
  <diagram name="페이지-1" id="XCwguPV3iCqasTkN0QVd">
    <mxGraphModel dx="2660" dy="1771" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="TrRbaetDsdgHLVqCblbi-3" value="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;&quot; color=&quot;#007fff&quot;&gt;&lt;b&gt;apps_kwd_task()&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(apps_kwd.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 기동어 인식을 위한 엔진 함수&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 기동어 인식 시 호출되는 callback 함수 정의 (&lt;b&gt;CB_onDetected&lt;/b&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 무한루프를 돌면서 768byte씩 ring buffer로부터 음성 녹음을 읽고 pcm_buffer라는 array에 저장&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;어떻게 꺼지는지도 확인해봐야겠다&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-300" y="-230" width="290" height="150" as="geometry" />
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-5" value="&lt;div style=&quot;&quot;&gt;&lt;b style=&quot;color: rgb(0, 127, 255);&quot;&gt;makeDecisionLNE(&lt;/b&gt;&lt;font color=&quot;#f8cecc&quot;&gt;i, anti_score, keyword_score&lt;/font&gt;&lt;b style=&quot;color: rgb(0, 127, 255);&quot;&gt;)&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(KWS_DNN_Decoder.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 음성 energy score를 통해 기동어가 맞는지 판단&amp;nbsp;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" parent="1" vertex="1">
          <mxGeometry x="530" y="-185" width="270" height="90" as="geometry" />
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-10" value="&lt;div style=&quot;&quot;&gt;&lt;b style=&quot;color: rgb(0, 127, 255);&quot;&gt;CB_onDetected(&lt;/b&gt;&lt;font color=&quot;#f8cecc&quot;&gt;...,length,...&lt;/font&gt;&lt;b style=&quot;color: rgb(0, 127, 255);&quot;&gt;)&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(apps_kwd.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 기동어 녹음 길이를 알려주는 epd_skip_byte 지정&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- Modem에게 FID_EPD_SKIP_BYPTES로 epd_skip_bytes 정보 전달&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- Modem에게 FID_ACTIVE_MIC_STATUS로 멀티턴 정보 전달 ( 처음에는 무조건 0)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;- APPS_VR_MANAGER_TASK에게 eVR_MANAGER_WAKEUP_DONE를 보냄&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;- seamless를 위한 timer 실행&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" parent="1" vertex="1">
          <mxGeometry x="210" y="-3" width="520" height="170" as="geometry" />
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-11" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="140" y="-240" width="260" height="200" as="geometry" />
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-8" value="&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-weight: bold;&quot; color=&quot;#007fff&quot;&gt;Process_Wakeup(&lt;/font&gt;&lt;font style=&quot;&quot; color=&quot;#f8cecc&quot;&gt;pcm_buffer, ...&lt;/font&gt;&lt;font style=&quot;font-weight: bold;&quot; color=&quot;#007fff&quot;&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(HATWDengineCore.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;fillColor=default;" parent="TrRbaetDsdgHLVqCblbi-11" vertex="1">
          <mxGeometry width="260" height="200" as="geometry" />
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-4" value="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- pcm 파일에서 mfcc 추출&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- mfcc에서 energy score를 판단&amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" parent="TrRbaetDsdgHLVqCblbi-11" vertex="1">
          <mxGeometry x="10" y="50" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-9" value="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 기동어 인식이라고 판단되면 &lt;b&gt;CB_onDetected&lt;/b&gt; 함수 실행&lt;/span&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" parent="TrRbaetDsdgHLVqCblbi-11" vertex="1">
          <mxGeometry x="10" y="124" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-12" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint y="-170" as="sourcePoint" />
            <mxPoint x="130" y="-170" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-13" value="&lt;b&gt;pcm_buffer&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="23" y="-190" width="80" height="24" as="geometry" />
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-16" value="" style="endArrow=classic;html=1;rounded=0;entryX=-0.035;entryY=0.333;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="410" y="-175.5" as="sourcePoint" />
            <mxPoint x="521.9499999999998" y="-175.02999999999997" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-17" value="음성 에너지 점수" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="413" y="-203" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-18" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="520" y="-110" as="sourcePoint" />
            <mxPoint x="415" y="-110" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-19" value="&lt;b&gt;결과&lt;br&gt;&lt;/b&gt;1 : 인식&lt;br&gt;0 : 보류&lt;br&gt;-1: 미인식" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="440" y="-110" width="60" height="66" as="geometry" />
        </mxCell>
        <mxCell id="TrRbaetDsdgHLVqCblbi-20" value="&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;b style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot; color=&quot;#007fff&quot;&gt;APPS_VR_MANAGER_TASK()&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(service_vr_manager.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- DQC에서 다음 실행할 동작을 제어해주는 handler thread&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 무한 루프를 돌면서 msg를 받으면 그것을 바로 case 마다 처리&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="150" y="480" width="501" height="900" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-1" value="&lt;div style=&quot;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#007fff&quot;&gt;Send_message_to_vr_manager()&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(service_vr_manager.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- main vr_manager task에게 다음 실행해야 할 부분을 message 형태로 가공해서 보내주는 함수&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- SendMsg(&lt;b&gt;APPS_VR_MANAGER_TASK_ID&lt;/b&gt;, &amp;amp;message)로 전송&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="210" y="340" width="390" height="100" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-2" value="&lt;div style=&quot;&quot;&gt;case &lt;b&gt;eVR_MANAGER_WAKEUP_DONE&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- MODEM에게 vr status를 전송 ( 1을 전송)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- &lt;b&gt;wifi 가 연결 되어있다면:&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;1.&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;APPS_VR_MANAGER_TASK에게 eTYPE_VOICE_FEEDBACK_LED를 실행하도록 VR_FEEDBACK_WAKEUP_ACCEPTED의 정보를 전달&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;2.&amp;nbsp;APPS_VR_MANAGER_TASK에게 eVR_MANAGER_ACTIVATE_ASR_THREAD를 보내서 asr 실행&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;b&gt;- wifi 가 연결되어있지 않다면:&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;1.&amp;nbsp;APPS_VR_MANAGER_TASK에게 eTYPE_VOICE_FEEDBACK_LED를실행하도록 VR_FEEDBACK_ASR_ERROR_RESULT의 정보를 전달&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;border-color: var(--border-color); background-color: initial;&quot;&gt;2. 네트워크 에러 음성 파일을 playlist queue에 넣는다&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="161" y="570" width="480" height="220" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-3" value="&lt;div style=&quot;&quot;&gt;case &lt;b&gt;eTYPE_VOICE_FEEDBACK_LED&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;- 인자로 받은 led 정보를 g_sound_apps -&amp;gt;vr_manager_led_feedback_value에 저장 -&amp;nbsp;&lt;/div&gt;- 인자로 받은 led 정보를&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;send_to_led_vr_event로 전송&lt;/span&gt;&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="161" y="810" width="480" height="70" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-4" value="&lt;div style=&quot;&quot;&gt;case &lt;b&gt;eVR_MANAGER_ACTIVATE_ASR&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- MODEM에게 vr status를 전송 ( 1을 전송)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- &lt;b&gt;stop_deinit_vr_core_wakeup&lt;/b&gt;():&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;실제 기동어 엔진을 중단하지 않고 KWD_status 만 false로 지정 (어차피 기동어 엔진이 while 문 돌다가 여기로 온거니까, asr이 다 끝나면 다시 기동어 인식으로 자연스럽게 돌아갈 것이다&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- &lt;b&gt;stop_deinit_vr_core_asr():&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;만약에 asr thread가 돌고 있었다면 그것을 멈춰줌&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;- &lt;b&gt;init_start_vr_core_asr():&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp;g_sound_apps-&amp;gt;dqc_vr_state = DQC_VR_STATE_ASR&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;epd_skip_byte 가 0이 아니면 &lt;b&gt;store_detected_sound &lt;/b&gt;함수를 통해 기동어 녹음을 저장&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;/div&gt;activate_engine(LGAI_VOICE_RECOGNITION_NLP_TYPE, LGAI_ACTIVATE&lt;span style=&quot;background-color: initial;&quot;&gt;) 실행&lt;br&gt;&lt;/span&gt;&lt;br&gt;LGAI_StartEngine(LGAI_VOICE_RECOGNITION_NLP_TYPE) 실행&lt;br&gt;&lt;br&gt;mAsrStatus = LGAI_ENGINE_STATUS_START&lt;br&gt;&lt;br&gt;needkwddatasend = DQC_TRUE (기동어 음성을 보내기 위함)&lt;br&gt;&lt;br&gt;main asr thread인 &lt;b&gt;APPS_VR_ASR_Task&lt;/b&gt; 실행&lt;br&gt;&lt;br&gt;asr_task_init()&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="160" y="904" width="480" height="466" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-5" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="627" as="sourcePoint" />
            <mxPoint x="140" y="830" as="targetPoint" />
            <Array as="points">
              <mxPoint x="90" y="627" />
              <mxPoint x="90" y="790" />
              <mxPoint x="90" y="830" />
              <mxPoint x="120" y="830" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-6" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;arg2:&amp;nbsp;&lt;br&gt;&lt;b&gt;VR_FEEDBACK_WAKEUP_ACCEPTED&lt;/b&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-42" y="700" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-7" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="670" y="730" as="sourcePoint" />
            <mxPoint x="660" y="820" as="targetPoint" />
            <Array as="points">
              <mxPoint x="700" y="730" />
              <mxPoint x="700" y="770" />
              <mxPoint x="700" y="820" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-8" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;arg2:&amp;nbsp;&lt;br&gt;&lt;b&gt;VR_FEEDBACK_ASR_ERROR_RESULT&lt;/b&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="710" y="737" width="107" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-80" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="sXWmz9hjVyttIy2R4i8F-9" target="sXWmz9hjVyttIy2R4i8F-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-9" value="&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;send_to_led_vr_event&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(service_vr_manager.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 각 led 정보에 해당하는 led_event를 정해서 led_send_event로 전송&lt;/span&gt;&lt;/div&gt;- VR_FEEDBACK_WAKEUP_ACCEPTED : mic 켜져있으면 LED_EVT_IDLE,&lt;br&gt;&amp;nbsp; &amp;nbsp;mic 꺼져있으면 LED_EVT_MIC_OFF&lt;br&gt;- VR_FEEDBACK_ASR_ERROR_RESULT : LED_EVT_NETWORK_ERROR&lt;br&gt;- VR_FEEDBACK_PLAY_SND : LED_EVT_ANSWERING&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="-1060" y="260" width="440" height="160" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-10" value="&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;led_send_event&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(apps_led.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- led main task인 &lt;b&gt;APPS_LED_TASK&lt;/b&gt;에게 msg를 보내주는 함수&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="-1060" y="530" width="440" height="70" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-14" value="&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;APPS_LED_TASK&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(apps_led.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- led 제어 메인 함수&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="-1565" y="260" width="440" height="430" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-15" value="&lt;div style=&quot;&quot;&gt;case &lt;b&gt;LED_EVT_IDLE&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- led_action(&lt;b&gt;LED_ID_WHITE&lt;/b&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="-1555" y="340" width="420" height="60" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-16" value="&lt;div style=&quot;&quot;&gt;case &lt;b&gt;LED_EVT_MIC_OFF&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- led_action(&lt;b&gt;LED_ID_ORANGE&lt;/b&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="-1555" y="425" width="420" height="60" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-17" value="&lt;div style=&quot;&quot;&gt;case &lt;b&gt;LED_EVT_NETWORK_ERROR&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- led_action(&lt;b&gt;LED_ID_NOTWORK_ERROR&lt;/b&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="-1555" y="510" width="420" height="60" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-18" value="&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;led_action&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(apps_led.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- led 빛을 제어하는 함수&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- APPS_LED_TASK에서 받은 action을 가지고 &lt;b&gt;led_set_color&lt;/b&gt; 실행&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="-1565" y="737" width="440" height="100" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-23" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.25;exitDx=0;exitDy=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-1060" y="547.5" as="sourcePoint" />
            <mxPoint x="-1122" y="300" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-1082" y="548" />
              <mxPoint x="-1082" y="300" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-24" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="133" y="860" as="sourcePoint" />
            <mxPoint x="-590" y="280" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-520" y="860" />
              <mxPoint x="-520" y="280" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-25" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="330" y="-52" as="sourcePoint" />
            <mxPoint x="330" y="-5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-28" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="190" y="130" as="sourcePoint" />
            <mxPoint x="200" y="370" as="targetPoint" />
            <Array as="points">
              <mxPoint x="90" y="130" />
              <mxPoint x="90" y="370" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-29" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;eVR_MANAGER_WAKEUP_DONE&lt;/b&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-10" y="220" width="32" height="20" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-32" value="&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;store_detected_sound()&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(service_vr_core_asr.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;/div&gt;- g_sound_apps-&amp;gt;detectedSound에 epd_skip_byte만큼 막 저장된 음성을 저장&lt;br&gt;- ring buffer에서 &lt;b&gt;vr_rb_prevdata &lt;/b&gt;함수를 통해 읽음&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="-350" width="440" height="105" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-38" value="&lt;div style=&quot;&quot;&gt;&lt;/div&gt;&lt;b style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;activate_engine(&lt;/font&gt;&lt;/b&gt;&lt;b style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;)&lt;/b&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(lib_wakeup_asr_tts.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;/div&gt;- LGAI_SetEngineActivate(LGAI_VOICE_RECOGNITION_NLP_TYPE, LGAI_ACTIVATE)&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="-280" y="1480" width="490" height="70" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-40" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;LGAI_VOICE_RECOGNITION_NLP_TYPE&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;text-align: left; font-size: 10px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;LGAI_ACTIVATE&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="1400" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-42" value="&lt;div style=&quot;&quot;&gt;&lt;/div&gt;&lt;b style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;LGAI_SetEngineActivate(&lt;/font&gt;&lt;/b&gt;&lt;b style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;)&lt;/b&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(LGAI_API.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 각 nlp, tts의 engine의 활성화 또는 비활성화 status를 정해주는 함수&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="-194.5" y="1760" width="424.5" height="280" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-43" value="&lt;div style=&quot;&quot;&gt;case &lt;b&gt;LGAI_VOICE_RECOGNITION_NLP_TYPE:&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;- mAsrActivation = &lt;b&gt;LGAI_ACTIVATE&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;- mAsrStatus = &lt;b&gt;LGAI_ENGINE_STATUS_IDLE&lt;/b&gt;&lt;/div&gt;&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="-186.5" y="1840" width="406.5" height="70" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-45" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-60" y="1563" as="sourcePoint" />
            <mxPoint y="1753" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-46" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="1150" as="sourcePoint" />
            <mxPoint x="41" y="1457" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-47" value="&lt;div style=&quot;&quot;&gt;&lt;/div&gt;&lt;b style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;LGAI_StartEngine(&lt;/font&gt;&lt;/b&gt;&lt;b style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;)&lt;/b&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(LGAI_API.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 각 nlp, tts의 engine의 시작 함수를 불러주는 함수&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="360" y="1760" width="390" height="280" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-48" value="&lt;div style=&quot;&quot;&gt;case &lt;b&gt;LGAI_VOICE_RECOGNITION_NLP_TYPE:&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;- startAsrNlp()&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="368" y="1840" width="372" height="70" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-50" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="194" y="403" as="sourcePoint" />
            <mxPoint x="144" y="593" as="targetPoint" />
            <Array as="points">
              <mxPoint x="34" y="403" />
              <mxPoint x="34" y="593" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-51" value="&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;b&gt;eVR_MANAGER_WAKEUP_DONE&lt;/b&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="34" y="440" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-54" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="155" y="1120" as="sourcePoint" />
            <mxPoint x="-195" y="117" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-195" y="1120" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-55" value="&lt;div style=&quot;&quot;&gt;&lt;/div&gt;&lt;b style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;startAsrNlp(&lt;/font&gt;&lt;/b&gt;&lt;b style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;)&lt;/b&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(LGAI_API.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;/div&gt;- MODEM에게 FID_START_ASR_NLP를 보냄&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="368" y="2100" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-58" value="&lt;div style=&quot;&quot;&gt;&lt;/div&gt;&lt;b style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;asr_task_init(&lt;/font&gt;&lt;/b&gt;&lt;b style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;)&lt;/b&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(service_vr_core_asr.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;/div&gt;- 만약에 멀티턴이면 modem에게 FID_ACTIVE_MIC_STATUS보내줌&lt;br&gt;- error가 없을 시 g_sound_apps-&amp;gt;vr_asr_server_ready를 DQC_TRUE로 지정&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="970" y="1430" width="490" height="90" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-59" value="&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;b style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot; color=&quot;#007fff&quot;&gt;APPS_VR_ASR_TASK()&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(service_vr_core_asr.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 음성 녹음을 modem으로 전송해주는 main thread&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- detected_sound_process()를 통해 modem으로 저장된 명령어 전송&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- asr_end_of_speech_done&amp;nbsp; 이 0, 즉 아직 발화중이라면 읽은 만큼을 modem으로 LGAI_Process를 통해 전송&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 음성인식이 끝났고 6초안에 tts 응답이 안 올 경우 ( !asr_reponse_time_done)&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;/div&gt;1. send_message_to_vr_manager(eTYPE_VOICE_FEEDBACK_LED, 0, VR_FEEDBACK_PLAY_SND);&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;2. 음성 playlist에 &lt;b&gt;&quot;잠시만 기다려주세요&quot;&lt;/b&gt; 음원 전송&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1189" y="485" width="641" height="900" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-63" value="&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;detected_sound_process()&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(service_vr_core_asr.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;/div&gt;- g_sound_apps-&amp;gt;detectedSound에 저장된 음성 파일을 3072만큼씩 modem으로 LGAI_Process를 통해 전송&lt;br&gt;- 다 보낸뒤 epd_skip_byte를 0으로 만들어서 멀티턴일때 기동어 음성 파일을 다시 보내는 것을 방지" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="801" width="440" height="105" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-64" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="340" y="1850" as="sourcePoint" />
            <mxPoint x="350" y="2120" as="targetPoint" />
            <Array as="points">
              <mxPoint x="300" y="1850" />
              <mxPoint x="300" y="2120" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-66" value="&lt;div style=&quot;&quot;&gt;&lt;/div&gt;&lt;b style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;LGAI_Process(&lt;/font&gt;&lt;/b&gt;&lt;b style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;)&lt;/b&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(LGAI_API.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- 각 nlp, tts의 engine을 실행 (execute) 해주는 함수&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="890" y="1760" width="390" height="280" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-67" value="&lt;div style=&quot;&quot;&gt;case &lt;b&gt;LGAI_VOICE_RECOGNITION_NLP_TYPE:&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;- runAsrNlp()&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="898" y="1840" width="372" height="70" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-68" value="&lt;div style=&quot;&quot;&gt;&lt;/div&gt;&lt;b style=&quot;&quot;&gt;&lt;font color=&quot;#007fff&quot;&gt;runAsrNlp(&lt;/font&gt;&lt;/b&gt;&lt;b style=&quot;color: rgb(0, 127, 255); background-color: initial;&quot;&gt;)&lt;/b&gt;&lt;font color=&quot;#007fff&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#cccc00&quot;&gt;(LGAI_API.c)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;/div&gt;- MODEM에게 FID_RUN_ASR_NLP를 보냄, 이때 음성 파일도 같이 보냄&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="908" y="2100" width="320" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-69" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="880" y="1850" as="sourcePoint" />
            <mxPoint x="890" y="2120" as="targetPoint" />
            <Array as="points">
              <mxPoint x="840" y="1850" />
              <mxPoint x="840" y="2120" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-71" value="" style="endArrow=classic;html=1;strokeColor=#000000;rounded=0;dashed=1;dashPattern=8 8;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1170" y="640" as="sourcePoint" />
            <mxPoint x="630" y="400" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1110" y="640" />
              <mxPoint x="1110" y="400" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-77" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;dashPattern=8 8;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="175" y="390" as="sourcePoint" />
            <mxPoint x="140" y="840" as="targetPoint" />
            <Array as="points">
              <mxPoint x="15" y="390" />
              <mxPoint x="20" y="840" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-78" value="VR_FEEDBACK_PLAY_SND" style="text;html=1;strokeColor=default;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;dashed=1;dashPattern=8 8;" vertex="1" parent="1">
          <mxGeometry x="-157" y="485" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-79" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;dashPattern=8 8;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="143" y="866" as="sourcePoint" />
            <mxPoint x="-580" y="286" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-510" y="866" />
              <mxPoint x="-510" y="286" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-81" value="&lt;div style=&quot;&quot;&gt;case &lt;b&gt;LED_EVT_ANSWERING&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- led_action(&lt;b&gt;LED_ID_ANSWERING&lt;/b&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;labelPosition=center;verticalLabelPosition=middle;verticalAlign=top;spacingRight=0;spacingLeft=2;" vertex="1" parent="1">
          <mxGeometry x="-1555" y="590" width="420" height="60" as="geometry" />
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-82" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-831" y="420" as="sourcePoint" />
            <mxPoint x="-831" y="530" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sXWmz9hjVyttIy2R4i8F-83" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.25;exitDx=0;exitDy=0;dashed=1;dashPattern=8 8;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-1063" y="556.5" as="sourcePoint" />
            <mxPoint x="-1125" y="309" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-1085" y="557" />
              <mxPoint x="-1085" y="309" />
            </Array>
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
